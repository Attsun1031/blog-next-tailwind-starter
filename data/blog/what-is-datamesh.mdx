---
title: 'Data Meshとは何か？ - 真にスケーラブルなデータ基盤を求めて -'
date: '2021-03-23'
draft: false
summary: 'Data Meshについての解説記事です。'
tags: ['data', 'tech', 'datamesh']
---

# TL;DR

- この記事は、「Data Mesh」について書かれたものです。参考文献に記載された内容をベースとして、個人的な感想や意見を加えたものです。
- Data Mesh はデータ基盤の新しいアーキテクチャ原則であり、主流である中央集中型のデータ基盤と、そこから起こる問題への解決策です。
- Data Mesh はマイクロサービスと DDD から着想を得ており、データの生成・管理・配信を中央ではなくドメインごとに管理します。
- 管理が分散することでスケーラビリティ・自律性を確保しつつ、統一的なガバナンスを保持できるアイデアです。

### 主な想定読者

- Data Mesh が気になる方
- データ基盤を開発・保守するデータエンジニア

# Data Mesh の登場した背景 (WHY)

詳細に入る前に、Data Mesh が前提に置く現代のデータ基盤アーキテクチャと、その課題についてまとめます。

## 現代のデータ基盤アーキテクチャと課題

[Zhamak Dehghani](https://martinfowler.com/articles/data-monolith-to-mesh.html) によると、現代のデータ基盤は中央に集中されたモノリシックなものです。

この中央の DataLake や、ETL、DataMart/DWH を生成するパイプラインの開発／管理は特定のプロダクトチームに属さないチーム（基盤チームと呼ぶ）のデータエンジニアがしています。

![current_data_architecture](/static/images/datamesh/current_data_architecture.png)

このアーキテクチャの課題は、責務が中央に集中しており、スケーラビリティが欠けていることです。

Zhamak Dehghani は、3 つの "Architectural failure modes" として、現代のアーキテクチャの問題点を指摘しています。

1. 中央集権でモノリシックな基盤 (Centralized and monothlic)
1. パイプラインのステージごとでの分割 (Coupled pipeline decomposition)
1. サイロ化された基盤チーム (Siloed and hyper-specialized ownership)

これらにより起こる具体的な問題は以下のようなものです。

- 新しいデータパイプラインの開発は基盤チームとの認識合わせといったコミュニケーションコストや、基盤ームが別チームのタスクを抱えているとすぐには着手できないといった事情により、スピードが出ない
- パイプラインは挿入・加工・サービングの３つのステージが疎結合に分解されているが、例えば新しいデータを活用したい場合、挿入・加工・サービングすべてに変更を加える必要がある。
- プロダクトチームが自分たちで完結できるのが最も効率的だが、基盤を触るには特殊な「データエンジニアスキル」が必要となり、ハードルが高い。

<Note
  title="個人メモ"
  desc="だいたい同意できるが、2番目の点のみ少しイメージがわかなかった。確かにアーキテクチャ上は分解されているが、管理しているのは基盤チームなのであまり問題にならないような気もするが。管理者が異なるということなら理解できる。"
></Note>

サービスは DDD などにより綺麗に責務分解されていても、データに関してはデータレイクに入れた瞬間にオーナーシップが手放されてしまいコントロールが思うにようにできなくなる、ということも述べられています。

しかしながら、中央集権的なデータ基盤ではなく、各ドメインに任せたときには以下のようなガバナンスの問題が出てきてしまいます。

- 各ドメインで車輪の再発明のようなことが必要となる
- データの保存・変換・提供の方法が各ドメインでバラバラになり、ドメインをまたいだデータ活用がしづらくなる
- アクセスコントロールなどのセキュリティ観点の対策がドメイン任せとなり、リスクが増大する

## Data Mesh が解決を試みる点

上記のように、現代のデータ基盤はスケーラビリティの問題を抱えている一方、単純に解消しようとするとガバナンスの問題が浮上してきてしまいます。

Data Mesh は、まさにこういった板挟みの状況を脱却し、 **スケーラビリティとガバナンスの両方を得るアーキテクチャ** として提案されています。

具体的にはどのようなものか、以下で確認しましょう。

# Data Mesh とは (WHAT)

簡潔に述べると、「Data As A Product」として、データの保存・変換・提供を各ドメインの責務としつつ、それらの基盤は「Data Infrastructure」により構成することで速度と標準化を担保するというものです。

## アーキテクチャ

アーキテクチャとしては以下のようなイメージです。物理的なアーキテクチャではなく、概念図として捉えてください。

![datamesh_architecture](/static/images/datamesh/datamesh_architecture.png)

最初にお見せしたアーキテクチャとは随分違いますね。ポイントは以下 2 点です。

- 中央のデータレイクがなく、各ドメインが、保有するデータの ETL・提供 (インターフェースは SQL/API など利用者次第) を担っている
- 共通部分として Data Infrastructure がおり、ここが標準化やディスカバリを担保している。

## Data As A Product

ここから

## Data Infrastructure

# Data Mesh をいつ適用すべきか (WHEN)

# Data Mesh をどう実装すべきか (HOW)

# まとめ

# 参考文献
